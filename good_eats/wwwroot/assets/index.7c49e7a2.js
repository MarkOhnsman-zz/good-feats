var X=Object.defineProperty,Z=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var I=(a,e,t)=>e in a?X(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,M=(a,e)=>{for(var t in e||(e={}))te.call(e,t)&&I(a,t,e[t]);if(O)for(var t of O(e))se.call(e,t)&&I(a,t,e[t]);return a},N=(a,e)=>Z(a,ee(e));import{r as ae,c as p,a as w,o as l,b as d,d as n,e as f,w as k,F as T,f as g,t as _,g as D,h as ne,i as oe,j as re,k as ie,S as L,l as ce,p as q,m as V,M as j,n as B,q as A,s as H,u as le,v as de,x as C,y as U,z as ue,A as _e}from"./vendor.94bb8d8d.js";const me=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerpolicy&&(c.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?c.credentials="include":o.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}};me();const u=ae({user:{},account:{},restaurants:[],activeRestaurant:{},reviews:[],activeProfile:{}});var y=(a,e)=>{for(const[t,s]of e)a[t]=s;return a};const ve={name:"App",setup(){return{appState:p(()=>u),restaurant:p(()=>u.activeRestaurant)}}};function he(a,e,t,s,o,c){const i=w("Navbar"),r=w("router-view"),b=w("RestaurantModal"),Q=w("Modal");return l(),d(T,null,[n("header",null,[f(i)]),n("main",null,[f(r)]),f(Q,{id:"restaurant-modal"},{"modal-title":k(()=>[g(_(s.restaurant.name),1)]),"modal-body":k(()=>[f(b)]),_:1})],64)}var ge=y(ve,[["render",he]]);const pe={},fe={class:"modal",tabindex:"-1"},be={class:"modal-dialog modal-xl"},we={class:"modal-content"},ye={class:"modal-header"},xe={class:"modal-title"},Re=n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ke={class:"modal-body p-0"};function Ae(a,e){return l(),d("div",fe,[n("div",be,[n("div",we,[n("div",ye,[n("h5",xe,[D(a.$slots,"modal-title")]),Re]),n("div",ke,[D(a.$slots,"modal-body")])])])])}var Ee=y(pe,[["render",Ae]]),Se=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ee});const F=window.location.origin.includes("localhost"),z=F?"https://localhost:5001":"",Te="bcw-harrisonw.us.auth0.com",Ce="VswNnhtKmw8npDG6i67MB2OTyc3HwpcJ",Pe="https://sandbox.com",$e="modulepreload",K={},Oe="/",E=function(e,t){return!t||t.length===0?e():Promise.all(t.map(s=>{if(s=`${Oe}${s}`,s in K)return;K[s]=!0;const o=s.endsWith(".css"),c=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${c}`))return;const i=document.createElement("link");if(i.rel=o?"stylesheet":$e,o||(i.as="script",i.crossOrigin=""),i.href=s,document.head.appendChild(i),o)return new Promise((r,b)=>{i.addEventListener("load",r),i.addEventListener("error",b)})})).then(()=>e())};function Ie(a){switch(a){case"./pages/AboutPage.vue":return E(()=>import("./AboutPage.130b7f1d.js"),["assets/AboutPage.130b7f1d.js","assets/vendor.94bb8d8d.js"]);case"./pages/AccountPage.vue":return E(()=>import("./AccountPage.2ce426a4.js"),["assets/AccountPage.2ce426a4.js","assets/AccountPage.68e73645.css","assets/vendor.94bb8d8d.js"]);case"./pages/HomePage.vue":return E(()=>import("./HomePage.a1a7a660.js"),["assets/HomePage.a1a7a660.js","assets/vendor.94bb8d8d.js"]);case"./pages/ProfilePage.vue":return E(()=>import("./ProfilePage.e4183649.js"),["assets/ProfilePage.e4183649.js","assets/ProfilePage.6d2cea4f.css","assets/vendor.94bb8d8d.js"]);default:return new Promise(function(e,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+a)))})}}function P(a){return()=>Ie(`./pages/${a}.vue`)}const Me=[{path:"/",name:"Home",component:P("HomePage")},{path:"/profile/:id",name:"Profile",component:P("ProfilePage")},{path:"/account",name:"Account",component:P("AccountPage"),beforeEnter:re}],W=ne({linkActiveClass:"router-link-active",linkExactActiveClass:"router-link-exact-active",history:oe(),routes:Me});function x(a,e){if(F)console[a](`[${a}] :: ${new Date().toLocaleTimeString()} :: `,...e);else{switch(a){case"log":case"assert":return}console[a](`[${a}] :: ${new Date().toLocaleTimeString()} :: `,...e)}}const v={log(){x("log",arguments)},error(){x("error",arguments)},warn(){x("warn",arguments)},assert(){x("assert",arguments)},trace(){x("trace",arguments)}},h=ie.create({baseURL:z,timeout:8e3});class Ne{async getAccount(){try{const e=await h.get("/account");u.account=e.data}catch(e){v.error("HAVE YOU STARTED YOUR SERVER YET???",e)}}}const De=new Ne;class ${static async confirm(e="Are you sure?",t="You won't be able to revert this!",s="warning",o="Yes, delete it!"){try{return!!(await L.fire({title:e,text:t,icon:s,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:o})).isConfirmed}catch{return!1}}static toast(e="Warning!",t="warning",s="top-end",o=3e3,c=!0){L.fire({title:e,icon:t,position:s,timer:o,timerProgressBar:c,toast:!0,showConfirmButton:!1})}}const Le={connection:"connection",connected:"connected",disconnect:"disconnect",authenticate:"authenticate",authenticated:"authenticated",userConnected:"userConnected",userDisconnected:"userDisconnected",error:"error"};class qe{constructor(e=!1,t=z){}on(e,t){var s;return(s=this.socket)==null||s.on(e,t.bind(this)),this}onConnected(e){v.log("[SOCKET_CONNECTION]",e),this.connected=!0,this.playback()}onAuthenticated(e){v.log("[SOCKET_AUTHENTICATED]",e),this.authenticated=!0,this.playback()}authenticate(e){var t;(t=this.socket)==null||t.emit(Le.authenticate,e)}onError(e){v.error("[SOCKET_ERROR]",e)}enqueue(e,t){v.log("[ENQUEING_ACTION]",{action:e,payload:t}),this.queue.push({action:e,payload:t})}playback(){v.log("[SOCKET_PLAYBACK]");const e=[...this.queue];this.queue=[],e.forEach(t=>{this.emit(t.action,t.payload)})}emit(e,t=void 0){if(this.requiresAuth&&!this.authenticated)return this.enqueue(e,t);if(!this.connected)return this.enqueue(e,t);this.socket.emit(e,t)}}class Ve extends qe{constructor(){super();this.on("error",this.onError)}onError(e){$.toast(e.message,"error")}}const Y=new Ve,m=ce({domain:Te,clientId:Ce,audience:Pe,useRefreshTokens:!0,onRedirectCallback:a=>{W.push(a&&a.targetUrl?a.targetUrl:window.location.pathname)}});m.on(m.AUTH_EVENTS.AUTHENTICATED,async function(){h.defaults.headers.authorization=m.bearer,h.interceptors.request.use(je),u.user=m.user,await De.getAccount(),Y.authenticate(m.bearer)});async function je(a){if(!m.isAuthenticated)return a;const e=m.identity.exp*1e3,t=e<Date.now(),s=e<Date.now()+1e3*60*60*12;return t?await m.loginWithPopup():s&&(await m.getTokenSilently(),h.defaults.headers.authorization=m.bearer,Y.authenticate(m.bearer)),a}const Be={setup(){return{user:p(()=>u.user),async login(){m.loginWithPopup()},async logout(){m.logout({returnTo:window.location.origin})}}}},S=a=>(q("data-v-7604c986"),a=a(),V(),a),He={class:"navbar navbar-expand-lg navbar-light bg-primary px-3 d-flex justify-content-between"},Ue=S(()=>n("div",{class:"d-flex flex-column align-items-center"},[n("h2",null,"Good Eats")],-1)),Fe=S(()=>n("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},[n("span",{class:"navbar-toggler-icon"})],-1)),ze={class:"collapse navbar-collapse",id:"navbarText"},Ke={class:"navbar-text"},We={key:1,class:"dropdown my-2 my-lg-0"},Ye={class:"dropdown-toggle selectable","data-bs-toggle":"dropdown","aria-expanded":"false",id:"authDropdown"},Ge=["src"],Je={class:"mx-3 text-success lighten-30"},Qe={class:"dropdown-menu p-0 list-group w-100","aria-labelledby":"authDropdown"},Xe=S(()=>n("div",{class:"list-group-item list-group-item-action hoverable"}," Manage Account ",-1)),Ze=S(()=>n("i",{class:"mdi mdi-logout"},null,-1)),et=g(" logout "),tt=[Ze,et];function st(a,e,t,s,o,c){const i=w("router-link");return l(),d("nav",He,[f(i,{class:"navbar-brand d-flex",to:{name:"Home"}},{default:k(()=>[Ue]),_:1}),Fe,n("div",ze,[n("span",Ke,[s.user.isAuthenticated?(l(),d("div",We,[n("div",Ye,[n("img",{src:s.user.picture,alt:"user photo",height:"40",class:"rounded"},null,8,Ge),n("span",Je,_(s.user.name),1)]),n("div",Qe,[f(i,{to:{name:"Account"}},{default:k(()=>[Xe]),_:1}),n("div",{class:"list-group-item list-group-item-action hoverable text-danger",onClick:e[1]||(e[1]=(...r)=>s.logout&&s.logout(...r))},tt)])])):(l(),d("button",{key:0,class:"btn selectable text-success lighten-30 text-uppercase my-2 my-lg-0",onClick:e[0]||(e[0]=(...r)=>s.login&&s.login(...r))}," Login "))])])])}var at=y(Be,[["render",st],["__scopeId","data-v-7604c986"]]),nt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:at});class ot{async getAll(){const e=await h.get("api/restaurants");u.restaurants=e.data}async setActive(e){u.activeRestaurant=e;const t=await h.get(`api/restaurants/${e.id}/reviews`);u.reviews=t.data}}const rt=new ot;const it={props:{restaurant:{type:Object,required:!0}},setup(a){return{async setActive(){await rt.setActive(a.restaurant),j.getOrCreateInstance(document.getElementById("restaurant-modal")).toggle()}}}},ct={class:"d-flex bg-white"},lt={class:"flex-shrink-0"},dt=["src"],ut={class:"flex-grow-1 d-flex elevation-1 ps-3"},_t={class:""},mt={class:"m-0 border-bottom"},vt={class:"d-flex"},ht={class:"p-2 rounded bg-secondary"},gt={class:"ms-3"},pt={key:0,class:"mdi mdi-star-half text-warning"};function ft(a,e,t,s,o,c){return l(),d("div",{class:"restaurant p-4",onClick:e[0]||(e[0]=(...i)=>s.setActive&&s.setActive(...i))},[n("div",ct,[n("div",lt,[n("img",{class:"elevation-1",src:t.restaurant.picture,height:"100"},null,8,dt)]),n("div",ut,[n("div",_t,[n("h3",mt,_(t.restaurant.name),1),n("p",null,[n("b",null,_(t.restaurant.address),1)]),n("div",vt,[n("p",ht,_(t.restaurant.category),1)])]),n("h3",gt,[g(_(t.restaurant.averageRating.toFixed(1))+" ",1),(l(!0),d(T,null,B(Math.floor(t.restaurant.averageRating),i=>(l(),d("i",{class:"mdi mdi-star text-warning",key:i}))),128)),Math.floor(t.restaurant.averageRating)<Math.round(t.restaurant.averageRating)?(l(),d("i",pt)):A("",!0),n("span",null,"("+_(t.restaurant.totalReviews)+")",1)])])])])}var bt=y(it,[["render",ft],["__scopeId","data-v-7dcc40df"]]),wt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:bt});class yt{async createReview(e){const t=await h.post("api/reviews",e);console.log(t.data),u.reviews.push(t.data)}async deleteReview(e){await h.delete("api/reviews/"+e),u.reviews=u.reviews.filter(t=>t.id!=e)}}const G=new yt;const xt={setup(){const a=H(!1),e=H({rating:1}),t=le();return{createForm:a,newReview:e,restaurant:p(()=>u.activeRestaurant),reviews:p(()=>u.reviews),account:p(()=>u.account),async createReview(){try{const s=N(M({},e.value),{restaurantId:u.activeRestaurant.id});await G.createReview(s)}catch(s){v.error(s),$.toast("Something Went Wrong!","error")}},async deleteReview(s){try{await G.deleteReview(s)}catch(o){v.error(o),$.toast("Something went wrong")}},goToProfile(s){j.getOrCreateInstance(document.getElementById("restaurant-modal")).hide(),t.push({name:"Profile",params:{id:s}})}}}},R=a=>(q("data-v-7ca82508"),a=a(),V(),a),Rt={class:"component d-flex"},kt=["src"],At={class:"p-3"},Et=R(()=>n("i",{class:"mdi mdi-star text-warning"},null,-1)),St={class:"reviews"},Tt={class:"text-end"},Ct={class:"d-flex justify-content-end align-items-center"},Pt=R(()=>n("button",{class:"btn btn-success"},"create",-1)),$t={class:"d-flex"},Ot={class:"mx-2"},It=R(()=>n("label",{class:"mx-1",for:"body"},"Review: ",-1)),Mt={class:"mx-2"},Nt={class:"mx-1",for:"rating"},Dt={class:"mx-2"},Lt=R(()=>n("label",{class:"mx-1",for:"publish"},"Publish?",-1)),qt={class:"m-0"},Vt=["onClick"],jt=R(()=>n("i",{class:"mdi mdi-star"},null,-1)),Bt=g(") "),Ht={key:0,class:"text-end"},Ut=["onClick"];function Ft(a,e,t,s,o,c){var i;return l(),d("div",Rt,[n("img",{class:"img-fluid w-50",src:s.restaurant.picture},null,8,kt),n("div",At,[n("div",null,[n("h3",null,[g(_(s.restaurant.address)+" | Rating: "+_((i=s.restaurant.averageRating)==null?void 0:i.toFixed(1))+" ",1),Et]),n("div",St,[n("div",Tt,[!s.createForm&&s.account.id?(l(),d("button",{key:0,class:"btn btn-outline-success mdi mdi-plus",onClick:e[0]||(e[0]=r=>s.createForm=!0)})):A("",!0),s.createForm?(l(),d("form",{key:1,class:"my-3",onSubmit:e[5]||(e[5]=de((...r)=>s.createReview&&s.createReview(...r),["prevent"]))},[n("div",Ct,[n("p",{class:"m-0 mx-3 selectable p-2",onClick:e[1]||(e[1]=r=>s.createForm=!1)}," cancel "),Pt]),n("div",$t,[n("div",Ot,[It,C(n("input",{type:"text",placeholder:"Review...","onUpdate:modelValue":e[2]||(e[2]=r=>s.newReview.body=r),required:"",minlength:"10",maxlength:"255"},null,512),[[U,s.newReview.body]])]),n("div",Mt,[n("label",Nt,_(s.newReview.rating),1),C(n("input",{type:"range",min:"1",max:"5",class:"slider","onUpdate:modelValue":e[3]||(e[3]=r=>s.newReview.rating=r)},null,512),[[U,s.newReview.rating]])]),n("div",Dt,[Lt,C(n("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=r=>s.newReview.published=r)},null,512),[[ue,s.newReview.published]])])])],32)):A("",!0)]),(l(!0),d(T,null,B(s.reviews,r=>(l(),d("div",{class:"p-3 bg-primary darken-35 m-3 text-light text-uppercase",key:r.id},[n("p",qt,[g(' "'+_(r.body)+'" - ',1),n("span",{class:"selectable",onClick:b=>s.goToProfile(r.creatorId)},_(r.creator.name),9,Vt),g(" ("+_(r.rating)+" ",1),jt,Bt]),r.creatorId==s.account.id?(l(),d("div",Ht,[n("i",{class:"mdi mdi-delete selectable",onClick:b=>s.deleteReview(r.id)},null,8,Ut)])):A("",!0)]))),128))])])])])}var zt=y(xt,[["render",Ft],["__scopeId","data-v-7ca82508"]]),Kt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:zt});function Wt(a){Object.entries({"./components/Modal.vue":Se,"./components/Navbar.vue":nt,"./components/Restaurant.vue":wt,"./components/RestaurantModal.vue":Kt}).forEach(([t,s])=>{const o=s.name||t.substr(t.lastIndexOf("/")+1).replace(/\.\w+$/,"");a.component(o,s.default)})}const J=_e(ge);Wt(J);J.use(W).mount("#app");export{u as A,y as _,h as a,v as l,rt as r};
